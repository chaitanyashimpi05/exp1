Experiment No. 9
Setting up a simple honeypot to detect &
analyze potential intrusions

Aim:
Set up a low-effort SSH/Telnet honeypot (Cowrie) on a Kali VM to attract, log, and analyze intrusion
attempts in an isolated lab network.

Requirements:
• Kali Linux (VM) — one machine for the honeypot.
• Optional second VM to act as an attacker/victim (to test).
• Tools: git, python3, virtualenv, pip, jq, net-tools, tcpdump, Wireshark.
• Isolated lab network (VirtualBox/VMware internal network or host-only). Do not expose this to
the public Internet.
• ~1–2 GB free disk, ~2 CPU cores, 2+ GB RAM.
Procedure:
Step 1: Prepare the VM & network (isolate!)
1. Create/boot Kali VM on an internal-only network (VirtualBox “Host-only” or “Internal
Network”).
2. Update packages:
sudo apt update && sudo apt upgrade -y
sudo apt install -y git python3 python3-venv python3-pip build-essential libssl-dev libffi-dev libpython3-
dev jq

Step 2: Create a non-root user for Cowrie
sudo useradd -m -s /bin/bash cowrie
sudo passwd cowrie # set a password for lab use
sudo usermod -aG sudo cowrie # optional if needed for tests

Switch to that user:
su - cowrie

Step 3: Clone Cowrie and create virtualenv
cd ~
git clone https://github.com/cowrie/cowrie.git
cd cowrie
python3 -m venv cowrie-env
source cowrie-env/bin/activate
pip install --upgrade pip
pip install -r requirements.txt

Step 4: Minimal Cowrie configuration (easy)
1. Copy the example config:
cp etc/cowrie.cfg.dist etc/cowrie.cfg
2. Edit etc/cowrie.cfg (only a couple of quick tweaks):
[honeypot]
listen_addr = 0.0.0.0 # bind to all local interfaces (or set specific IP)
listen_port = 2222 # use non-privileged port to avoid sudo
(You can use port 2222 so you don't need root. If you want port 22, additional steps as root are required.)
Step 5: Start Cowrie
From cowrie directory (still as cowrie user with venv active):
bin/cowrie start
# to stop:
bin/cowrie stop
# to view running status:
bin/cowrie status

Step 6: Verify honeypot is reachable (from attacker VM)
On attacker/test VM in same internal network:
ssh -p 2222 someuser@<honeypot_IP>
# try weak credentials / type some commands — Cowrie will log them (it emulates a shell)

Step 7: Monitor logs & captures
Cowrie log locations (inside cowrie directory):

• var/log/cowrie/cowrie.log — human-readable events
• var/lib/cowrie/ — contains tty recordings and session data
• var/log/cowrie/cowrie.json — JSON event logs (great for parsing)

Quick checks:
# tail logs
tail -f var/log/cowrie/cowrie.log
# see last JSON events
tail -n 50 var/log/cowrie/cowrie.json | jq '.'
# list recorded sessions
ls -lah var/lib/cowrie/tty/*.log

Step 8: Analyze events (simple examples)
Smple examples :

• Count unique source IPs:
jq -r '.src_ip' var/log/cowrie/cowrie.json | sort | uniq -c | sort -rn | head

• Show commands attackers tried:
jq -r 'select(.eventname=="cowrie.session.command") | "\(.src_ip) \(.format) \(.input)"'
var/log/cowrie/cowrie.json | tail -n 50

• Inspect a session’s tty log:
less var/lib/cowrie/tty/ttylog-*.log

Step 9: Stop & cleanup
bin/cowrie stop
deactivate # leave virtualenv
# if needed, remove cowrie directory

Expected Outcomes:
• Cowrie will emulate SSH/Telnet and log attempted connections, credentials, and attacker
commands.
• You will be able to identify attack sources, common usernames/passwords tried, and commands
run.
• PCAP captures will let you correlate network-level details with logged sessions.
• Students learn how honeypots record attacker behavior and how to perform basic forensic
analysis.